## 需求分析

### 我们想要做什么？

用一句话来概括就是，我们要做一个简易版的博客系统。

那我们需要什么功能？既然说是简易版的博客系统，那么自然要提取出最简要的模块需求：用户模块和博客模块。

### 用户模块

博客是什么？按照维基百科上的解释是这样的：

>博客（英语：Blog，为Web Log的混成词），意指log on the web意即在网络上纪录，是一种由个人管理、张贴新的文章、图片或视频的网站或在线日记，用来纪录、抒发情感或分享信息[1]。博客上的文章通常根据张贴时间（Chronological Order），以倒序方式由新到旧排列。

也就是说，博客是由用户记录的，所以用户模块是博客最基本的需求之一。像现在网络上流行的那些博客，它们的用户模块基本上都涵盖了注册、登录、登出、个人信息查改和关注好友等功能。在此处我们并不想把一个用户模块设计得过于复杂，为了便于各位理解和学习，我们把用户模块精简到只剩下三个功能即可：注册、登录和登出。

事实上只剩下这三个功能，也还是可以把代码逻辑写得很复杂。比如说在注册的时候我们为了用户的安全想在前端给密码加密，然后在后端再给加密后的密码加盐在加密；又或者说我们想在登录的时候想要加一个验证码模块，这些需求都会使代码复杂化很多。因此我们继续剔除一些暂时不需要的逻辑，只保留最基本的功能：

* 注册：前端做一次密码确认，然后给密码做md5加密然后发给后端保存。
* 登录：单纯做用户名和密码的登录操作。
* 登出：登出系统，跳转回登录页面。

### 博客模块

博客模块是这个博客系统的核心。我们根据常见的博客系统可以确定我们需要的页面：

* 博客列表页面：可以看见自己写的所有博客的列表，为了简单我们就不做分页、搜索和筛选等功能。
* 博客详情页面：可以看见某篇具体博客的详情，里面只包含博客标题和博客内容。
* 博客编辑页面：提供一个富文本编辑器来编写博客。
* 创建博客页面：与博客编辑页面类似，在此不赘述。
* 异常跳转页面：如同浏览器的404页面般，用来告诉用户异常信息的静态页面。

### 跳转逻辑

按照之前的需求确定，我们知道这个博客系统会有登录注册页面、博客相关页面和异常页面。其中当跳转产生异常时需要跳转到异常页面这个逻辑我相信大家都没有异议，关键的是其他两类页面的跳转。

登录注册页面只有在用户属于未登录的状态进入这个博客系统后会跳转的页面。这句话的意思就是当一个用户在登录注册页面登录后跳转到博客相关页面后，这个用户再次进入登录注册页面时系统会检测到他已登录的状态，然后同样跳转到博客相关页面。

而博客相关页面则和登录注册页面相反，当系统检测到一个用户没有登录的状态时，就算这个用户进入的是博客相关页面也会强制将其跳转到登录注册页面。

用一张图来简单描述下就是：

```
有登录状态 ----> 进入登录注册页面 ----> 跳转到博客相关页面
有登录状态 ----> 进入博客相关页面 ----> 不跳转

无登录状态 ----> 进入博客相关页面 ----> 跳转到登录注册页面
无登录状态 ----> 进入登录注册页面 ----> 不跳转
```

### 数据库设计

分析到这时，其实已经可以确定整个系统的数据库的设计。我们选用轻量又常见的数据库——MYSQL，并且确定数据库名字为**express_blog_demo**。

根据上面定下来的两个基本模块，我们可以设计两张表来分别对应这两个模块：**user**表和**blog**表。

* user表：包含用户名`username`字段和`password`字段。
* blog表：包含标题`title`字段、创建者`username`字段和内容`content`字段，同时还包含系统自增主键`id`字段和系统自动添加的创建时间`create_time`字段。

整个建表的SQL语句如下：

```sql
CREATE DATABASE IF NOT EXISTS express_blog_demo DEFAULT CHARSET UTF8;

USE express_blog_demo;

# 清除表结构
DROP TABLE IF EXISTS user;
DROP TABLE IF EXISTS blog;

# 用户表
CREATE TABLE user
(
    username         VARCHAR(50) NOT NULL DEFAULT "" COMMENT "用户名",
    password         VARCHAR(50) NOT NULL DEFAULT "" COMMENT "密码",
    PRIMARY KEY (username)
)
ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT "用户表";

# 博客表
CREATE TABLE blog
(
    id               BIGINT NOT NULL AUTO_INCREMENT,
    title            VARCHAR(50) NOT NULL DEFAULT "" COMMENT "名称",
    username         VARCHAR(50) NOT NULL DEFAULT "" COMMENT "作者",
    create_time      TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT "创建时间",
    content          TEXT NOT NULL COMMENT "内容",
    PRIMARY KEY (id)
)
ENGINE=InnoDB AUTO_INCREMENT=10000 DEFAULT CHARSET=utf8 COMMENT "博客表";
```